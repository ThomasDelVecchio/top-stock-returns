# Top Stocks Trend Analysis

This project analyzes \~1,000 large-cap stocks using multi-horizon
returns, trend scoring, volatility-adjusted strength, and several
momentum/pullback signals.

Outputs include: - Master sheet with full universe - Top Trend 10 - Top
Sector Leaders - Top Final 10 - Cheat Sheet + Mathematical Appendix

------------------------------------------------------------------------

## ðŸš€ Features

-   Scrapes tickers from StockAnalysis.com
-   Pulls 1-year pricing data via Yahoo Finance
-   Computes 1W, 1M, 3M, 6M returns
-   Calculates percentile trend scores
-   Computes volatility-adjusted ranking
-   Detects pullbacks and accelerating momentum
-   Consolidates results into a clean Excel report

------------------------------------------------------------------------

## ðŸ“Š Excel Output Structure

### **Master**

-   Full stock universe\
-   Columns: 1W, 1M, 3M, 6M percentage returns\
-   Sortable directly in Excel

### **Top_Trend_10**

-   Best consistent performers\
-   Includes trend score, volatility-adjusted strength, trend health,
    and flags

### **Top_Sector_Leaders**

-   Top 3 per sector by composite trend score

### **Top_Final_10**

-   Final weighted recommendation list\
-   Combines all scoring dimensions

------------------------------------------------------------------------

# ðŸ“˜ Cheat Sheet

See `Trend_Analysis_CheatSheet.docx` for a condensed explanation.

------------------------------------------------------------------------

# ðŸ“¦ Running the Script

``` bash
python top_return_ranks.py
```

Outputs: - `top1000_returns_master.csv` - `top1000_return_report.xlsx`

------------------------------------------------------------------------

# ðŸ“ Repository Structure

    README.md
    top_return_ranks.py
    Sample_Report.xlsx
    Sample_Master.csv
    Trend_Analysis_CheatSheet.docx
    Math_Appendix.md

------------------------------------------------------------------------

# ðŸ“˜ Mathematical Appendix

# ðŸ“˜ Mathematical Appendix: Full Calculation Methodology

This appendix documents **every numerical field** generated by the Top
Stocks Trend Analysis engine.\
All formulas below match the exact logic used in the Python script.

------------------------------------------------------------------------

# 1. Price Inputs

For each stock:

-   Daily adjusted close prices: ( P_t )
-   Timeline indexed by days: ( t = 1, 2, ..., T )

All return calculations use **autoâ€‘adjusted close** from Yahoo Finance.

------------------------------------------------------------------------

# 2. Horizon Returns

For each horizon ( H `\in`{=tex}{7, 30, 90, 180} ):

Let: - ( P\_{ ext{end}} ) = last available price - ( P\_{ ext{start}} )
= closest trading day at least ( H ) days earlier

**Formula:**

\[ ext{Return}*H = `\left`{=tex}( rac{P*{ ext{end}}}{P\_{
ext{start}}} - 1 ight) imes 100 \]

Outputs columns:

-   **1W Return**
-   **1M Return**
-   **3M Return**
-   **6M Return**

------------------------------------------------------------------------

# 3. Trend Percentile Scores

Each horizon return (e.g., 1W, 1M...) is ranked among all stocks.

Let: - rank = 1 for best return - ( n ) = number of stocks

**Percentile Score:**

\[ ext{score} = 1 - rac{ ext{rank} - 1}{n - 1} \]

Columns:

-   **1w_score**
-   **1m_score**
-   **3m_score**
-   **6m_score**

------------------------------------------------------------------------

# 4. Composite Trend Score

Average of the four horizon percentile scores:

\[ ext{composite_score} = rac{ ext{1w_score} + ext{1m_score} +
ext{3m_score} + ext{6m_score} }{4} \]

Range: **0 -- 1**

------------------------------------------------------------------------

# 5. Volatility (6-month daily standard deviation)

Daily returns:

\[ r_t = rac{P_t - P\_{t-1}}{P\_{t-1}} \]

Volatility:

\[ ext{vol_6m} = ext{std}(r_t) \]

Used for risk-adjusted metrics.

------------------------------------------------------------------------

# 6. Risk-Adjusted Strength (Sharpe-like)

Convert 6M % return to fraction:

\[ R\_{6m} = rac{ ext{6m}}{100} \]

Then:

\[ ext{risk_adj_score} = rac{R\_{6m}}{ ext{vol_6m}} \]

If vol = 0 â†’ **NA**.

------------------------------------------------------------------------

# 7. Risk-Adjusted Percentile Rank

Same percentile method as trend score:

\[ ext{risk_adj_pct} = 1 - rac{ ext{rank} - 1}{n - 1} \]

------------------------------------------------------------------------

# 8. Moving Average Flags

Let:

-   ( MA\_{50} ) = 50-day simple moving average\
-   ( MA\_{200} ) = 200-day moving average\
-   ( P\_{ ext{last}} ) = latest price

Flags:

\[ ext{above_50d} = (P\_{ ext{last}} \> MA\_{50}) \]

\[ ext{above_200d} = (P\_{ ext{last}} \> MA\_{200}) \]

Values stored as **Yes/No**.

------------------------------------------------------------------------

# 9. Pullback Flag

A strong stock with a recent dip:

-   Long-term strong:

\[ ext{strong} = ( ext{3m} `\ge 25`{=tex}%) `\land`{=tex}( ext{6m}
`\ge 40`{=tex}%) \]

-   Short-term dip:

\[ ext{recent_dip} = ( ext{1w} `\le 0`{=tex}) `\lor`{=tex}( ext{1m}
`\le 0`{=tex}) \]

Combined:

\[ ext{pullback_flag} = ext{strong} `\land`{=tex}ext{recent_dip} \]

------------------------------------------------------------------------

# 10. New Momentum (Acceleration) Flag

All horizons must be positive:

\[ ext{all_pos} = ( ext{1w}\>0)`\land`{=tex}( ext{1m}\>0)`\land`{=tex}(
ext{3m}\>0)`\land`{=tex}( ext{6m}\>0) \]

Acceleration rules:

\[ ext{1m} `\ge`{=tex}rac{ ext{3m}}{3} \]

\[ ext{3m} `\ge`{=tex}rac{ ext{6m}}{3} \]

Final:

\[ ext{new_momentum_flag} = ext{all_pos} `\land`{=tex}ext{acceleration
rules} \]

------------------------------------------------------------------------

# 11. Final Score (Master Ranking)

Weighted combination:

\[ ext{final_score} = 0.4 `\cdot`{=tex}ext{composite_score} ;+; 0.3
`\cdot`{=tex}ext{risk_adj_pct} ;+; 0.2
`\cdot`{=tex}ext{new_momentum_flag} ;+; 0.1
`\cdot`{=tex}ext{pullback_flag} \]

Flags are numeric (1 = Yes, 0 = No).\
Range: **0 -- 1**.

------------------------------------------------------------------------

# 12. Sector Assignment

Pulled via:

``` python
yf.Ticker(symbol).info.get("sector", "Unknown")
```

------------------------------------------------------------------------

# âœ… End of Appendix

This appendix can be linked directly in your GitHub README for clarity.
